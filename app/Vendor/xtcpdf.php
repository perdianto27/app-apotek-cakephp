<?php

App::import('Vendor', 'tcpdf/tcpdf');

class XTCPDF extends TCPDF {

    public $xheadertext = 'PDF created using CakePHP and TCPDF';
    public $xheadercolor = array(0, 0, 200);
    public $nama_aplikasi = 'Copyright © Mizno Kruge. All rights reserved.';
    public $xfooterfont = PDF_FONT_NAME_MAIN;
    public $xfooterfontsize = 6;
    public $namaorg = 'CV. Gaivo Systemworks Indonesia';
    public $alamat = "Graha Raflesia, Jl.Raflesia Selatan 11 no 10 Citra Raya, Tangerang Banten 15710";
    public $telp = '+62 81310974914';
    public $fax = "+62 81310974914";
    public $email = 'info@gaivo.co.id';
    public $website = 'https://gaivo.co.id';
    public $logo = '../webroot/img/logo.png';
    public $username = '';
    public $current_user;

    /**
     * Overwrites the default header
     * set the text in the view using
     *    $fpdf->xheadertext = 'YOUR ORGANIZATION';
     * set the fill color in the view using
     *    $fpdf->xheadercolor = array(0,0,100); (r, g, b)
     * set the font in the view using
     *    $fpdf->setHeaderFont(array('YourFont','',fontsize));
     */
    function Header() {

        $style = array('width' => 0.5, 'cap' => 'butt', 'join' => '', 'dash' => 0, 'color' => array(255, 0, 0));
        $bMargin = $this->getBreakMargin();
        // get current auto-page-break mode
        $auto_page_break = $this->AutoPageBreak;
        // disable auto-page-break
        $this->SetAutoPageBreak(false, 0);
        // set bacground image
        //$this->Cell(0, 10, '<img src="' . $img_file . '">');
        $this->SetMargins(55, 30);
        
        $this->SetFont('helvetica', 'B', 10);
        
        #$this->Cell(0, 100, $this->namaorg, 0, false, 'L', 0, '', 0, false, 'M', 'M');   
        $this->Ln(3);
        $this->Cell(0, 100, $this->namaorg, 0, false, 'L', 0, '', 0, false, 'M', 'M'); 
        $this->Ln(5);
        $this->SetFont('helvetica', '', 9);
        $this->Cell(0, 100, $this->alamat, 0, false, 'L', 0, '', 0, false, 'M', 'M');
        $this->Ln(3);
        $telp = 'Telp : ' . $this->telp;
        $this->Cell(0, 10, $telp, 0, false, 'L', 0, '', 0, false, 'M', 'M');
        $this->Ln(3);
        $this->Cell(0, 10, 'Fax : ' . $this->fax, 0, false, 'L', 0, '', 0, false, 'M', 'M');
        $this->Ln(3);
        $this->Cell(0, 10, $this->email . ' ' . $this->website, 0, false, 'L', 0, '', 0, false, 'M', 'M');
        $this->Image($this->logo, 10, 5, 40, 15, '', '', '', false, 300, '', false, false, 0);
        $this->Line(0, 25, 1000, 25, $style);
        // restore auto-page-break status
        $this->SetAutoPageBreak($auto_page_break, $bMargin);
        // set the starting point for the page content
        $this->setPageMark();
    }

    /**
     * Overwrites the default footer
     * set the text in the view using
     * $fpdf->xfootertext = 'Copyright Â© %d YOUR ORGANIZATION. All rights reserved.';
     */
    function Footer() {
        $year = date('Y');
        $footertext = 'Generated by ' . $this->nama_aplikasi . '   -      ' . $this->current_user . '    -    ' . date("d F Y, G:i:a");
        $this->SetY(-20);
        $this->SetTextColor(0, 0, 0);
        $this->SetFont($this->xfooterfont, '', 6);
        $this->Cell(0, 8, $footertext, 'T', 1, 'C');
    }
    
    function debug($d, $k = false) {
        print_r($d);
        if ($k):
            die;
        endif;
    }

}
